<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Videy - URL Rotator</title>
    <!-- (CSS bisa Anda kustomisasi) -->
    <style>body{font-family:sans-serif;background:#1a1a1a;color:#e0e0e0;display:flex;justify-content:center;align-items:center;min-height:100vh;margin:0;padding:20px;box-sizing:border-box}.container{width:100%;max-width:550px;background:#2c2c2c;padding:30px;border-radius:12px;box-shadow:0 8px 32px rgba(0,0,0,.3)}.header{text-align:center;margin-bottom:25px}.header h2{margin:0;font-size:24px;color:#8a63d2;font-weight:600}.form-group{margin-bottom:20px}label{display:block;margin-bottom:8px;font-size:14px;color:#a0a0a0}input,textarea{width:100%;padding:12px;border-radius:8px;border:1px solid #444;background:#222;color:#e0e0e0;box-sizing:border-box;font-size:14px}textarea{resize:vertical}button{width:100%;padding:14px;border-radius:8px;border:none;background:linear-gradient(90deg,#8a63d2,#6a43b2);color:#fff;font-size:16px;font-weight:700;cursor:pointer;transition:transform .2s}button:hover{transform:translateY(-2px)}#results-container{margin-top:25px}</style>
</head>
<body>
    <div class="container">
        <nav style="text-align: center; margin-bottom: 20px;">
            <a href="./index.html" style="color: #9ef;">Uploader</a> | 
            <a href="./shortener.html" style="color: #9ef;">URL Rotator</a>
        </nav>
        <div class="header"><h2>Dynamic URL Rotator</h2></div>
        <div class="form-group">
            <label for="adsterraLinks">Enter Adsterra Direct Link(s):</label>
            <textarea id="adsterraLinks" rows="3" placeholder="Satu URL per baris atau pisahkan dengan koma"></textarea>
        </div>
        <div class="form-group">
            <label for="videoCount">Number of video links to mix in:</label>
            <input type="number" id="videoCount" value="4">
        </div>
        <button id="generateBtn">Generate Rotated Links</button>
        <div id="results-container">
            <label for="outputLinks">Your Links:</label>
            <textarea id="outputLinks" rows="10" readonly placeholder="Generated links will appear here..."></textarea>
        </div>
    </div>
    <script>
        const VERCEL_BACKEND_URL = "https://videy-final-backend.vercel.app";
        const GITHUB_PAGES_BASE_URL = "https://adithikmah28.github.io/videy-final-frontend"; // Ganti 'videy-final-frontend' jika nama repo beda

        document.getElementById('generateBtn').addEventListener('click', async function() {
            const button = this;
            const outputLinks = document.getElementById('outputLinks');
            const adsterraLinksInput = document.getElementById('adsterraLinks').value.trim();
            const videoCount = parseInt(document.getElementById('videoCount').value, 10);

            if (!adsterraLinksInput) return alert('Please enter at least one Adsterra link.');
            
            button.disabled = true;
            button.textContent = 'Generating...';
            outputLinks.value = '';

            try {
                const adsterraLinks = adsterraLinksInput.split(/[\n,]+/).filter(link => link.trim() !== '');
                const response = await fetch(`${VERCEL_BACKEND_URL}/api/create-rotated-links`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ adsterraLinks, videoCount })
                });

                if (!response.ok) {
                    const err = await response.json();
                    throw new Error(err.error || 'Failed to generate links.');
                }

                const data = await response.json();
                const fullUrls = data.ids.map(id => `${GITHUB_PAGES_BASE_URL}/v.html?id=${id}`);
                outputLinks.value = fullUrls.join('\n');

            } catch (error) {
                alert('Error: ' + error.message);
            } finally {
                button.disabled = false;
                button.textContent = 'Generate Rotated Links';
            }
        });
    </script>
</body>
</html>